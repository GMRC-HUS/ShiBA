---
title: "Shiba"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Shiba}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup}
options(golem.app.prod = FALSE) # TRUE = production mode, FALSE = development mode

# Detach all loaded packages and clean your environment
golem::detach_all_attached()
# rm(list=ls(all.names = TRUE))

# Document and reload your package
#undebug(golem::document_and_reload)
golem::document_and_reload()

library(ShiBA)
```


```{r}
# Exemple glmShiba


fit <- ShiBA:::glm_Shiba(iris,formule =Sepal.Length ~., type="lin",refresh = 0)



```

```{r}
# exemple shibaplo


ShiBA:::shibaGlmPlot(fit,"lin",pars=names(fit$coefficients),hist = T)




```

```{r}


seuilTwoIt<- list(type = "seuil",plusieur_seuils=F,val =-1.1)

ShiBA:::shibaGlmPlot(fit,"lin",pars=names(fit$coefficients),hist = T,seuilTwoIt = seuilTwoIt,color_1 = "#0000FF",color_2 = "red", )
```



```{r}


ShiBA:::shibaGlmPlot(fit,"lin",pars=names(fit$coefficients),hist = F,seuilTwoIt = seuilTwoIt)

```


```{r}


seuilTwoIt<- list(type = "",plusieur_seuils=T,val=list(var= "Petal.Length",
                                                       theta_A_min=-1,
                                                       theta_A_max = 0,
                                                       theta_P_min=0,
                                                       theta_P_max = 1))

ShiBA:::shibaGlmTable(fit,type_glm = "lin" , seuilTwoIt = seuilTwoIt)
```


```{r}
seuilTwoIt<- list(type = "seuil",plusieur_seuils=T,val=c(0.1,0.52,-0.13,0.4,0.5))

ShiBA:::shibaGlmTable(fit,type_glm = "lin" , seuilTwoIt = seuilTwoIt)
```


```{r}
fit2 <- ShiBA:::glm_Shiba(mtcars,formule =vs~1, type="binom",refresh = 0)
```



```{r}
options(golem.app.prod = FALSE) # TRUE = production mode, FALSE = development mode

# Detach all loaded packages and clean your environment
golem::detach_all_attached()
# rm(list=ls(all.names = TRUE))

# Document and reload your package
#undebug(golem::document_and_reload)
golem::document_and_reload()

library(ShiBA)
library(ggplot2)




ShiBA:::shibaGlmTable(fit2,type_glm = "binom")
ShiBA:::diag_convergence(fit2)
```


```{r fig.height=100, fig.width=120}
library(ggplot2)
ggfst_lst_label_bld <- function(ggp){
  
  labels <- ggplot_build(ggp)$layout$panel_params[[1]]$x$get_labels()
  color<- rep("black", length(labels))
  color[c(1, length(color))] <- "#FF2424"
  face<- rep("plain", length(labels))
  face[c(1, length(face))] <- "bold"
  return(ggp+theme(
    
    axis.text.x= element_text(face = face,
                              color =color)
  ) )
}

print(ggfst_lst_label_bld(ggplot(mtcars, aes(x=cyl, y=mpg))+geom_point()))
```


